# 全局配置，适用于所有 Hub
ListenPort = 5000             # 所有 Hub 共享的监听端口
LogLevel = "info"
LogFilePath = "./logs/any-hub.log"
LogMaxSize = 100
LogMaxBackups = 10
LogCompress = true
StoragePath = "./storage"      # 磁盘缓存根目录，按 Hub/路径 划分
CacheTTL = 86400               # 全局缓存 TTL（秒），用于判断命中/过期
MaxMemoryCacheSize = 268435456 # 256MB
MaxRetries = 3
InitialBackoff = "1s"
UpstreamTimeout = "30s"

[[Hub]]
Name = "docker-cache"
Domain = "docker.hub.local"
Upstream = "https://registry-1.docker.io"
Proxy = ""
Type = "docker"                      # 省略 Module 时自动选择与 Type 同名的 Hook（此处为 docker）
# Module = "docker"                  # 如需明确指定，可取消注释
Rollout = "modular"
Username = ""
Password = ""
CacheTTL = 43200
EnableHeadCheck = true

[[Hub]]
Name = "composer-cache"
Domain = "composer.hub.local"
Upstream = "https://repo.packagist.org"
Type = "composer"
Module = "composer"                  # 显式绑定 composer Hook，启动时会验证 hook 是否已注册
Rollout = "dual"                     # 可选：legacy-only/dual/modular
CacheTTL = 21600

[[Hub]]
Name = "legacy-fallback"
Domain = "legacy.hub.local"
Upstream = "https://registry.npmjs.org"
Type = "npm"
Module = "legacy"                    # 仍未迁移的 Hub 可显式指定 legacy，诊断会标记为 legacy-only
Rollout = "legacy-only"
